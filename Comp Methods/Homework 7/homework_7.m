clear
clc

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%% Question 1 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

x(1) = 100;
x0 = x(1);
m = ((2^13)-1);
a = 17;

for i = 2:500
    x(i) = mod(a*x0,m);
    u1(i) = x(i)/m;
    x0 = x(i);
end

figure(1)
hist(u1)
xlabel('Variable')
ylabel('Frequency')

for i = 1:499
    c1(i) = corrcoef(u1(i),u1(i+1));
    v1 = [u1(i),u1(i+1)];
end

figure(2)
plot(v1)
xlabel('ui')
ylabel('ui+1')

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%% Question 2 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

y(1) = 100;
y0 = y(1);
b = 85;

for j = 2:500
    y(j) = mod(b*y0,m);
    u2(j) = y(j)/m;
    y0 = y(j);
end

figure(3)
hist(u2)
xlabel('Variable')
ylabel('Frequency')

for j = 1:499
    c2 = corrcoef(u2(j),u2(j+1));
    v2 = [u2(j),u2(j+1)];
end

figure(4)
plot(v2)
xlabel('ui')
ylabel('ui+1')

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Question 3 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

U = rand(1,1000);
alpha = 1;
beta = .5;
x = ((-log(1-U))/alpha).^(1/beta);

figure(5)
plot(x)

figure(6)
hist(x)
xlabel('Variable')
ylabel('Frequency')

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%% Question 4 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

for j = 1:3000
    
    N = 200;
    U4 = rand(1,N);
    x4 = -log(U4);
    
    %figure(8)
    %hist(x4)
    
    Z = zeros(1,200);
    k = zeros(1,200);
    Z(1) = 1;
    
    for i = 2:N
        if (x4(i) >= max(x4(1:i-1)))
            Z(i) = 1;
        else
            Z(i) = 0;
        end
    end
    
    Y(j) = sum(Z);
    k(j)  = N-Y(j);
end

figure(9)
hist(Y)
xlabel('Variable')
ylabel('Frequency')

M = mean(Y)

lambda = 1/(k+1);
i = 0;
p = exp(-lambda);
F = p;

while i<maxiter
    if U<F
        X = i;
    end
    
    p = p*lambda/(i+1);
    F = F+p;
    i = i+1;
end
